<div class="container">

    <br>
     <hr>
    <br>

    <h2>Lifetime Sales per Service</h2>
    <table id="example" class="table table-striped table-bordered" style="width: 1000px;">
	<thead class="thead-dark">
      <th>Service</th>
      <th>Total Sales</th>
		</thead>
		<tbody>
     <% @service_totals.each do |service_total| %>
		<tr>
         <td><%= service_total.service.service_name%></td>
        <td><%= number_to_currency service_total.sum%></td>
       <% end %>
		</tbody>
	</table>


    <br>
     <hr>
    <br>

     <h2>Lifetime Sales per Store</h2>
    <table id="example" class="table table-striped table-bordered" style="width: 1000px;">
	<thead class="thead-dark">
      <th>Store</th>
      <th>Total Sales</th>
		</thead>
		<tbody>
     <% @sales_by_store.each do |sales_by_store| %>
		<tr>
         <td><%= sales_by_store.store.store_name %></td>
        <td><%= number_to_currency sales_by_store.sum%></td>
       <% end %>
		</tbody>
	</table>


    <br>
     <hr>
    <br>
    <h2>Current Year Sales per Month</h2>
    <table id="example" class="table table-striped table-bordered" style="width: 1000px;">
	<thead class="thead-dark">
      <th>Month</th>
      <th>Total Sales</th>
		</thead>
		<tbody>
     <% @sales_by_month.each do |sales_by_month| %>
		<tr>
         <% if sales_by_month.month.year == Date.today.year %>
         <td><%= sales_by_month.month.strftime("%B") %></td>
        <td><%= number_to_currency sales_by_month.sales%></td>
        <% end %>
       <% end %>
		</tbody>
	</table>

    <br>
     <hr>
    <br>
    <h2>Previous Year Sales per Month</h2>
    <table id="example" class="table table-striped table-bordered" style="width: 1000px;">
	<thead class="thead-dark">
      <th>Month</th>
      <th>Total Sales</th>
		</thead>
		<tbody>
     <% @sales_by_month.each do |sales_by_month| %>
		<tr>
         <% if sales_by_month.month.year == Date.today.last_year.year  %>
         <td><%= sales_by_month.month.strftime("%B") %></td>
        <td><%= number_to_currency sales_by_month.sales%></td>
        <% end %>
       <% end %>
		</tbody>
	</table>


    <%  @array = []
        @labels = []
    i = 0
    @sales_by_month.each do |sale|
      if sale.month.year == Date.today.last_year.year  
      puts sale.sales
      puts sale.month.strftime("%B")
      i += 1
        @array << sale.sales.to_i
        @labels << sale.month.strftime("%B")
      end
      end%>

<canvas id="myChart" width="400" height="200"></canvas>
<script>
<%= @array.inspect.html_safe %>
var array = <%= @array.inspect.html_safe %>;
var labels = <%= @labels.inspect.html_safe %>;
var ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: labels,
        datasets: [{
            label: 'Sales per Month',
            data: array ,
            backgroundColor: [
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(153, 102, 255, 0.2)'
            ],
            borderColor: [
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(153, 102, 255, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});
</script>

</div>